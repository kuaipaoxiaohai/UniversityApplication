<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty Directory - Summer Research 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --background: #0f172a;
            --surface: #1e293b;
            --surface-light: #334155;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
            --stanford: #8c1515;
            --mit: #a31f34;
            --border: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
            padding: 3rem 2rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 70% 50%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            position: relative;
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 2rem;
            justify-content: center;
            padding: 1.5rem 2rem;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Controls */
        .controls {
            padding: 1.5rem 2rem;
            background: var(--surface);
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text);
            font-size: 1rem;
            transition: all 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .search-box::before {
            content: 'üîç';
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
        }

        .filter-btn {
            padding: 0.75rem 1.25rem;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--text);
        }

        .filter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        /* Faculty Grid */
        .faculty-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 1.5rem;
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Faculty Card */
        .faculty-card {
            background: var(--surface);
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .faculty-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .faculty-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .faculty-card:hover::before {
            opacity: 1;
        }

        .faculty-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text);
        }

        .faculty-title {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .faculty-school {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .school-stanford-cheme {
            background: rgba(140, 21, 21, 0.2);
            color: #f87171;
        }

        .school-stanford-mse {
            background: rgba(140, 21, 21, 0.2);
            color: #fb923c;
        }

        .school-stanford-doerr {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .school-mit-dmse {
            background: rgba(163, 31, 52, 0.2);
            color: #f472b6;
        }

        .school-harvard-chemistry,
        .school-harvard-seas {
            background: rgba(165, 42, 42, 0.2);
            color: #fca5a5;
        }

        .school-yale-chemistry {
            background: rgba(0, 53, 107, 0.2);
            color: #93c5fd;
        }

        .school-princeton-chemistry {
            background: rgba(255, 103, 31, 0.2);
            color: #fdba74;
        }

        .school-uchicago-chemistry {
            background: rgba(128, 0, 0, 0.2);
            color: #fca5a5;
        }

        .school-northwestern-chemistry,
        .school-northwestern-mse {
            background: rgba(78, 42, 132, 0.2);
            color: #c4b5fd;
        }

        .school-berkeley-chemistry,
        .school-berkeley-cbe {
            background: rgba(0, 50, 98, 0.2);
            color: #fcd34d;
        }

        .school-caltech-cce,
        .school-caltech-materials {
            background: rgba(255, 108, 47, 0.2);
            color: #fed7aa;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .contact-item a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .contact-item a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }

        .contact-icon {
            width: 20px;
            text-align: center;
        }

        .research-areas {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .research-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .research-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .research-tag {
            display: inline-block;
            padding: 0.3rem 0.75rem;
            background: rgba(99, 102, 241, 0.15);
            border-radius: 1rem;
            font-size: 0.8rem;
            color: var(--primary);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        /* Email Button Section */
        .card-actions {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.5rem;
        }

        .email-btn {
            flex: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border: none;
            border-radius: 0.5rem;
            color: white;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .email-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .profile-btn {
            padding: 0.75rem 1rem;
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .profile-btn:hover {
            border-color: var(--primary);
            color: var(--text);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--surface);
            border-radius: 1rem;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border);
            position: relative;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            position: sticky;
            top: 0;
            background: var(--surface);
            z-index: 10;
        }

        .modal-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }

        .modal-header .email-to {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .close-btn {
            background: var(--surface-light);
            border: none;
            color: var(--text);
            width: 36px;
            height: 36px;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .close-btn:hover {
            background: var(--primary);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .email-section {
            margin-bottom: 1.5rem;
        }

        .email-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .email-subject {
            background: var(--background);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            font-weight: 500;
            color: var(--text);
        }

        .email-content {
            background: var(--background);
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            white-space: pre-wrap;
            font-size: 0.9rem;
            line-height: 1.8;
            color: var(--text);
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-btn-primary {
            background: var(--primary);
            color: white;
            border: none;
        }

        .modal-btn-primary:hover {
            background: var(--primary-dark);
        }

        .modal-btn-secondary {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .modal-btn-secondary:hover {
            background: var(--surface-light);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--secondary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* No results */
        .no-results {
            text-align: center;
            padding: 4rem;
            color: var(--text-secondary);
            grid-column: 1 / -1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .stats-bar {
                gap: 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .faculty-grid {
                grid-template-columns: 1fr;
                padding: 1rem;
            }

            .controls {
                flex-direction: column;
                gap: 0.75rem;
            }

            .filter-btn {
                width: 100%;
                text-align: center;
            }

            .modal {
                margin: 0.5rem;
                max-height: 95vh;
            }

            .modal-footer {
                flex-direction: column;
            }

            .modal-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <h1>üéì Faculty Directory - Summer Research 2026</h1>
        <p>Personalized Cold Emails for Alex (Hung Yu Zhu) - BASIS International School Guangzhou</p>
    </header>

    <div class="stats-bar" id="statsBar">
        <div class="stat-item">
            <div class="stat-value" id="totalCount">-</div>
            <div class="stat-label">Total Faculty</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="emailCount">-</div>
            <div class="stat-label">With Email</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="phoneCount">-</div>
            <div class="stat-label">With Phone</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="pubCount">-</div>
            <div class="stat-label">With Publications</div>
        </div>
    </div>

    <div class="controls">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search by name, department, research...">
        </div>
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="stanford-cheme">Stanford ChemE</button>
        <button class="filter-btn" data-filter="stanford-mse">Stanford MSE</button>
        <button class="filter-btn" data-filter="stanford-doerr">Stanford Doerr</button>
        <button class="filter-btn" data-filter="mit-dmse">MIT DMSE</button>
        <button class="filter-btn" data-filter="harvard-chemistry">Harvard Chem</button>
        <button class="filter-btn" data-filter="harvard-seas">Harvard SEAS</button>
        <button class="filter-btn" data-filter="yale-chemistry">Yale Chem</button>
        <button class="filter-btn" data-filter="princeton-chemistry">Princeton Chem</button>
        <button class="filter-btn" data-filter="uchicago-chemistry">UChicago Chem</button>
        <button class="filter-btn" data-filter="northwestern-chemistry">NU Chem</button>
        <button class="filter-btn" data-filter="northwestern-mse">NU MSE</button>
        <button class="filter-btn" data-filter="berkeley-chemistry">Berkeley Chem</button>
        <button class="filter-btn" data-filter="berkeley-cbe">Berkeley CBE</button>
        <button class="filter-btn" data-filter="caltech-cce">Caltech CCE</button>
        <button class="filter-btn" data-filter="caltech-materials">Caltech MatSci</button>
    </div>

    <main class="faculty-grid" id="facultyGrid">
        <div class="loading">
            <div class="loading-spinner"></div>
            <p>Loading faculty data...</p>
        </div>
    </main>

    <!-- Email Modal -->
    <div class="modal-overlay" id="emailModal">
        <div class="modal">
            <div class="modal-header">
                <div>
                    <h3 id="modalTitle">Email Draft</h3>
                    <div class="email-to" id="modalEmailTo"></div>
                </div>
                <button class="close-btn" onclick="closeEmailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="email-section">
                    <div class="email-label">Subject Line</div>
                    <div class="email-subject" id="emailSubject"></div>
                </div>
                <div class="email-section">
                    <div class="email-label">Email Body</div>
                    <div class="email-content" id="emailBody"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="copyEmail()">üìã Copy Email</button>
                <a class="modal-btn modal-btn-primary" id="mailtoLink" href="#">‚úâÔ∏è Open in Email Client</a>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">‚úì Email copied to clipboard!</div>

    <script>
        let facultyData = [];
        let currentFilter = 'all';
        let currentSearch = '';
        let currentEmailData = null;

        // Determine school from department source
        function getSchool(source) {
            if (!source) return 'unknown';
            const s = source.toLowerCase();
            if (s.includes('cheme.stanford')) return 'stanford-cheme';
            if (s.includes('mse.stanford')) return 'stanford-mse';
            if (s.includes('sustainability.stanford')) return 'stanford-doerr';
            if (s.includes('dmse.mit') || s.includes('mit.edu')) return 'mit-dmse';
            if (s.includes('chemistry.harvard')) return 'harvard-chemistry';
            if (s.includes('seas.harvard')) return 'harvard-seas';
            if (s.includes('chem') && s.includes('yale')) return 'yale-chemistry';
            if (s.includes('chemistry.princeton')) return 'princeton-chemistry';
            if (s.includes('chemistry.uchicago')) return 'uchicago-chemistry';
            if (s.includes('chemistry.northwestern')) return 'northwestern-chemistry';
            if (s.includes('mccormick.northwestern') || s.includes('materials-science') && s.includes('northwestern')) return 'northwestern-mse';
            if (s.includes('chemistry.berkeley')) return 'berkeley-chemistry';
            if (s.includes('cbe') && s.includes('berkeley')) return 'berkeley-cbe';
            if (s.includes('cce.caltech')) return 'caltech-cce';
            if (s.includes('cms.caltech') || s.includes('materials') && s.includes('caltech')) return 'caltech-materials';
            return 'unknown';
        }

        function getSchoolLabel(school) {
            const labels = {
                'stanford-cheme': 'Stanford ChemE',
                'stanford-mse': 'Stanford MSE',
                'stanford-doerr': 'Stanford Doerr',
                'mit-dmse': 'MIT DMSE',
                'harvard-chemistry': 'Harvard Chem',
                'harvard-seas': 'Harvard SEAS',
                'yale-chemistry': 'Yale Chem',
                'princeton-chemistry': 'Princeton Chem',
                'uchicago-chemistry': 'UChicago Chem',
                'northwestern-chemistry': 'NU Chem',
                'northwestern-mse': 'NU MSE',
                'berkeley-chemistry': 'Berkeley Chem',
                'berkeley-cbe': 'Berkeley CBE',
                'caltech-cce': 'Caltech CCE',
                'caltech-materials': 'Caltech MatSci'
            };
            return labels[school] || 'Unknown';
        }

        function getUniversityName(school) {
            if (school.includes('stanford')) return 'Stanford University';
            if (school.includes('mit')) return 'MIT';
            if (school.includes('harvard')) return 'Harvard University';
            if (school.includes('yale')) return 'Yale University';
            if (school.includes('princeton')) return 'Princeton University';
            if (school.includes('uchicago')) return 'University of Chicago';
            if (school.includes('northwestern')) return 'Northwestern University';
            if (school.includes('berkeley')) return 'UC Berkeley';
            if (school.includes('caltech')) return 'Caltech';
            return 'the university';
        }

        function getDepartmentName(school) {
            const depts = {
                'stanford-cheme': 'Chemical Engineering',
                'stanford-mse': 'Materials Science and Engineering',
                'stanford-doerr': 'Stanford Doerr School of Sustainability',
                'mit-dmse': 'Materials Science and Engineering (DMSE)',
                'harvard-chemistry': 'Department of Chemistry and Chemical Biology',
                'harvard-seas': 'School of Engineering and Applied Sciences',
                'yale-chemistry': 'Department of Chemistry',
                'princeton-chemistry': 'Department of Chemistry',
                'uchicago-chemistry': 'Department of Chemistry',
                'northwestern-chemistry': 'Department of Chemistry',
                'northwestern-mse': 'Materials Science and Engineering',
                'berkeley-chemistry': 'Department of Chemistry',
                'berkeley-cbe': 'Chemical and Biomolecular Engineering',
                'caltech-cce': 'Division of Chemistry and Chemical Engineering',
                'caltech-materials': 'Division of Engineering and Applied Science'
            };
            return depts[school] || 'the department';
        }

        // Research field translation mapping
        const researchTranslations = {
            'materials science': 'ÊùêÊñôÁßëÂ≠¶', 'materials': 'ÊùêÊñô', 'nanomaterials': 'Á∫≥Á±≥ÊùêÊñô',
            'biomaterials': 'ÁîüÁâ©ÊùêÊñô', 'polymers': 'ËÅöÂêàÁâ©', 'polymer': 'ËÅöÂêàÁâ©',
            'ceramics': 'Èô∂Áì∑', 'metals': 'ÈáëÂ±ûÊùêÊñô', 'composites': 'Â§çÂêàÊùêÊñô',
            'semiconductors': 'ÂçäÂØº‰Ωì', 'thin films': 'ËñÑËÜú', 'crystals': 'Êô∂‰Ωì',
            'chemical engineering': 'ÂåñÂ≠¶Â∑•Á®ã', 'chemistry': 'ÂåñÂ≠¶', 'catalysis': 'ÂÇ¨Âåñ',
            'electrochemistry': 'ÁîµÂåñÂ≠¶', 'organic chemistry': 'ÊúâÊú∫ÂåñÂ≠¶',
            'synthesis': 'ÂêàÊàê', 'energy': 'ËÉΩÊ∫ê', 'renewable energy': 'ÂèØÂÜçÁîüËÉΩÊ∫ê',
            'solar energy': 'Â§™Èò≥ËÉΩ', 'batteries': 'ÁîµÊ±†', 'fuel cells': 'ÁáÉÊñôÁîµÊ±†',
            'hydrogen': 'Ê∞¢ËÉΩ', 'energy storage': 'ÂÇ®ËÉΩ', 'sustainability': 'ÂèØÊåÅÁª≠ÂèëÂ±ï',
            'climate': 'Ê∞îÂÄô', 'carbon capture': 'Á¢≥ÊçïËé∑', 'water': 'Ê∞¥ËµÑÊ∫ê',
            'machine learning': 'Êú∫Âô®Â≠¶‰π†', 'computational': 'ËÆ°ÁÆó', 'simulation': 'Ê®°Êãü',
            'nanotechnology': 'Á∫≥Á±≥ÊäÄÊúØ', 'manufacturing': 'Âà∂ÈÄ†'
        };

        function translateToChineseTag(text) {
            if (!text) return '';
            const lowerText = text.toLowerCase().trim();
            if (researchTranslations[lowerText]) return researchTranslations[lowerText];
            for (const [eng, chi] of Object.entries(researchTranslations)) {
                if (lowerText.includes(eng) || eng.includes(lowerText)) return chi;
            }
            return text.length > 20 ? text.substring(0, 18) + '...' : text;
        }

        function extractKeywordsFromText(text) {
            if (!text) return [];
            const lowerText = text.toLowerCase();
            const found = new Set();
            const keywordMap = {
                'nanomaterial': 'Á∫≥Á±≥ÊùêÊñô', 'nanoparticle': 'Á∫≥Á±≥ÊùêÊñô', 'nano': 'Á∫≥Á±≥ÊäÄÊúØ',
                'polymer': 'ËÅöÂêàÁâ©', 'biomaterial': 'ÁîüÁâ©ÊùêÊñô', 'semiconductor': 'ÂçäÂØº‰Ωì',
                'thin film': 'ËñÑËÜú', 'crystal': 'Êô∂‰Ωì', 'alloy': 'ÂêàÈáë', 'ceramic': 'Èô∂Áì∑',
                'graphene': 'Áü≥Â¢®ÁÉØ', 'catalysis': 'ÂÇ¨Âåñ', 'catalyst': 'ÂÇ¨Âåñ',
                'electrochemical': 'ÁîµÂåñÂ≠¶', 'solar': 'Â§™Èò≥ËÉΩ', 'battery': 'ÁîµÊ±†',
                'fuel cell': 'ÁáÉÊñôÁîµÊ±†', 'photovoltaic': 'ÂÖâ‰ºè', 'energy storage': 'ÂÇ®ËÉΩ',
                'hydrogen': 'Ê∞¢ËÉΩ', 'renewable': 'ÂèØÂÜçÁîüËÉΩÊ∫ê', 'lithium': 'ÈîÇÁîµÊ±†',
                'climate': 'Ê∞îÂÄô', 'carbon capture': 'Á¢≥ÊçïËé∑', 'sustainability': 'ÂèØÊåÅÁª≠ÂèëÂ±ï',
                'drug delivery': 'ËçØÁâ©ÈÄíÈÄÅ', 'protein': 'ËõãÁôΩË¥®', 'biomedical': 'ÁîüÁâ©ÂåªÂ≠¶',
                'machine learning': 'Êú∫Âô®Â≠¶‰π†', 'computational': 'ËÆ°ÁÆóÊ®°Êãü'
            };
            for (const [key, chinese] of Object.entries(keywordMap)) {
                if (lowerText.includes(key) && !found.has(chinese)) {
                    found.add(chinese);
                    if (found.size >= 4) break;
                }
            }
            return Array.from(found);
        }

        function getDefaultResearchAreas(school) {
            const defaults = {
                'stanford-cheme': ['ÂåñÂ≠¶Â∑•Á®ã', 'ÊùêÊñôÁßëÂ≠¶', 'ÂÇ¨Âåñ', 'ËÉΩÊ∫ê'],
                'stanford-mse': ['ÊùêÊñôÁßëÂ≠¶', 'Á∫≥Á±≥ÊùêÊñô', 'ÁîµÂ≠êÊùêÊñô', 'ÂäõÂ≠¶'],
                'stanford-doerr': ['ÂèØÊåÅÁª≠ÂèëÂ±ï', 'Ê∞îÂÄôÁßëÂ≠¶', 'ÁéØÂ¢ÉÂ∑•Á®ã', 'ËÉΩÊ∫ê'],
                'mit-dmse': ['ÊùêÊñôÁßëÂ≠¶', 'Á∫≥Á±≥ÊäÄÊúØ', 'ËÉΩÊ∫êÊùêÊñô', 'ÁîüÁâ©ÊùêÊñô'],
                'harvard-chemistry': ['ÊúâÊú∫ÂåñÂ≠¶', 'Êó†Êú∫ÂåñÂ≠¶', 'Áâ©ÁêÜÂåñÂ≠¶', 'ÁîüÁâ©ÂåñÂ≠¶'],
                'harvard-seas': ['Â∫îÁî®Áâ©ÁêÜ', 'Â∑•Á®ãÁßëÂ≠¶', 'ÊùêÊñôÁßëÂ≠¶', 'ËÉΩÊ∫ê'],
                'yale-chemistry': ['ÂåñÂ≠¶ÂêàÊàê', 'ÂÇ¨Âåñ', 'ÊùêÊñôÂåñÂ≠¶', 'ÁîüÁâ©ÂåñÂ≠¶'],
                'princeton-chemistry': ['ÂåñÂ≠¶Á†îÁ©∂', 'ÊùêÊñôÁßëÂ≠¶', 'ÂÇ¨Âåñ', 'ËÉΩÊ∫ê'],
                'uchicago-chemistry': ['ÂåñÂ≠¶Á†îÁ©∂', 'ÊùêÊñôÂåñÂ≠¶', 'Áâ©ÁêÜÂåñÂ≠¶', 'ÂÇ¨Âåñ'],
                'northwestern-chemistry': ['ÂåñÂ≠¶Á†îÁ©∂', 'Á∫≥Á±≥ÊùêÊñô', 'ÂÇ¨Âåñ', 'ËÉΩÊ∫ê'],
                'northwestern-mse': ['ÊùêÊñôÁßëÂ≠¶', 'Á∫≥Á±≥ÊäÄÊúØ', 'ËÉΩÊ∫êÊùêÊñô', 'ÁîüÁâ©ÊùêÊñô'],
                'berkeley-chemistry': ['ÂåñÂ≠¶Á†îÁ©∂', 'ÊùêÊñôÂåñÂ≠¶', 'ÂÇ¨Âåñ', 'ËÉΩÊ∫ê'],
                'berkeley-cbe': ['ÂåñÂ≠¶Â∑•Á®ã', 'ÁîüÁâ©Â∑•Á®ã', 'ÊùêÊñô', 'ËÉΩÊ∫ê'],
                'caltech-cce': ['ÂåñÂ≠¶Â∑•Á®ã', 'ÂÇ¨Âåñ', 'ÊùêÊñô', 'ËÉΩÊ∫ê'],
                'caltech-materials': ['ÊùêÊñôÁßëÂ≠¶', 'Â∫îÁî®Áâ©ÁêÜ', 'Á∫≥Á±≥ÊäÄÊúØ', 'ËÉΩÊ∫ê']
            };
            return defaults[school] || ['ÁßëÂ≠¶Á†îÁ©∂', 'Â∑•Á®ãÊäÄÊúØ'];
        }

        // Generate personalized email based on professor data
        function generateEmail(faculty) {
            const school = getSchool(faculty.department_source);
            const universityName = getUniversityName(school);
            const deptName = getDepartmentName(school);
            const lastName = faculty.name.split(',')[0].split(' ').pop().replace(/Professor|Dr\.|Prof\./gi, '').trim();

            // Extract research areas
            let researchAreas = [];
            if (faculty.research_interests && Array.isArray(faculty.research_interests)) {
                researchAreas = faculty.research_interests.slice(0, 3);
            } else if (faculty.top_publications) {
                const pubs = Array.isArray(faculty.top_publications) ? faculty.top_publications.join(' ') : faculty.top_publications;
                researchAreas = extractKeywordsFromText(pubs).map(chi => {
                    for (const [eng, c] of Object.entries(researchTranslations)) {
                        if (c === chi) return eng;
                    }
                    return chi;
                }).slice(0, 3);
            }

            // Build research interest sentence
            let researchSentence = '';
            if (researchAreas.length > 0) {
                const areas = researchAreas.join(', ').toLowerCase();
                researchSentence = `Your research on ${areas} deeply resonates with my academic interests and research background.`;
            } else {
                researchSentence = `Your pioneering contributions to ${deptName} deeply resonate with my academic interests and research background.`;
            }

            const subject = `Prospective Student Inquiry: Summer Research Opportunity in ${universityName}`;

            const body = `Dear Professor ${lastName},

I hope this email finds you well. My name is Alex (Hung Yu Zhu), and I am an eleventh-grade student at BASIS International School Guangzhou in China. I am writing to inquire about the possibility of joining your research group as a summer research assistant (unpaid) in 2026.

${researchSentence} Having reviewed your work and publications, I am particularly fascinated by how your group advances fundamental understanding while addressing real-world challenges.

Since ninth grade, I have been conducting research at the Key Laboratory of Low-carbon Chemistry & Energy Conservation of Guangdong Province at Sun Yat-sen University. There, I contributed to the development of poly(methyl ethylene carbonate-phthalate) (PPC-P), a novel fully biodegradable plastic synthesized from CO‚ÇÇ. My work specifically focused on the synthesis of CO‚ÇÇ-based polycarbonate diols and extended to 4D printing materials research. This hands-on experience has given me a strong foundation in polymer chemistry, experimental design, and materials characterization.

Academically, I maintain a 4.0 GPA, scored 1570 on the SAT (800 Math), and achieved 115 on TOEFL. I completed AP Chemistry with a perfect score of 5 in ninth grade, qualified for the Canadian Chemistry Olympiad (CCO) through CCC, and advanced to AIME through AMC 12.

I would be deeply grateful for the opportunity to contribute to your research in any capacity‚Äîwhether through data analysis, literature review, or hands-on experimental work. I am flexible regarding format (virtual or in-person).

Would you be open to a brief Zoom conversation to discuss potential opportunities? Alternatively, I would greatly appreciate being connected with a graduate student in your group who could offer guidance.

Thank you for your time and consideration. I have attached my CV for your reference.

Best regards,
Alex (Hung Yu Zhu)
BASIS International School Guangzhou
Grade 11`;

            return { subject, body, email: faculty.email };
        }

        // Create faculty card HTML
        function createCard(faculty, index) {
            const school = getSchool(faculty.department_source);
            const schoolLabel = getSchoolLabel(school);

            let contactHtml = '';
            if (faculty.email) {
                contactHtml += `
                    <div class="contact-item">
                        <span class="contact-icon">üìß</span>
                        <a href="mailto:${faculty.email}">${faculty.email}</a>
                    </div>`;
            }
            if (faculty.phone) {
                contactHtml += `
                    <div class="contact-item">
                        <span class="contact-icon">üìû</span>
                        <a href="tel:${faculty.phone}">${faculty.phone}</a>
                    </div>`;
            }
            if (faculty.lab_website) {
                const labUrl = faculty.lab_website.startsWith('http') ? faculty.lab_website : 'https://' + faculty.lab_website;
                contactHtml += `
                    <div class="contact-item">
                        <span class="contact-icon">üî¨</span>
                        <a href="${labUrl}" target="_blank">Lab Website</a>
                    </div>`;
            }
            if (faculty.google_scholar) {
                contactHtml += `
                    <div class="contact-item">
                        <span class="contact-icon">üìö</span>
                        <a href="${faculty.google_scholar}" target="_blank">Google Scholar</a>
                    </div>`;
            }

            let researchHtml = '';
            let interests = [];
            if (faculty.research_interests && Array.isArray(faculty.research_interests) && faculty.research_interests.length > 0) {
                interests = faculty.research_interests.map(i => translateToChineseTag(i));
            }
            if (interests.length === 0 && faculty.top_publications && faculty.top_publications.length > 0) {
                const pubs = Array.isArray(faculty.top_publications) ? faculty.top_publications.join(' ') : faculty.top_publications;
                interests = extractKeywordsFromText(pubs);
            }
            if (interests.length === 0) {
                interests = getDefaultResearchAreas(school);
            }

            if (interests.length > 0) {
                researchHtml = `
                    <div class="research-areas">
                        <div class="research-title">üî¨ Á†îÁ©∂ÊñπÂêë</div>
                        <div class="research-tags">
                            ${interests.slice(0, 4).map(i => `<span class="research-tag">${i}</span>`).join('')}
                        </div>
                    </div>`;
            }

            // Email button (only show if professor has email)
            let actionsHtml = '';
            if (faculty.email) {
                actionsHtml = `
                    <div class="card-actions">
                        <button class="email-btn" onclick="openEmailModal(${index})">üìù View Email Draft</button>
                        ${faculty.profile_url ? `<a class="profile-btn" href="${faculty.profile_url}" target="_blank">üîó</a>` : ''}
                    </div>`;
            } else if (faculty.profile_url) {
                actionsHtml = `
                    <div class="card-actions">
                        <a class="profile-btn" href="${faculty.profile_url}" target="_blank" style="flex:1;">üîó Profile Page</a>
                    </div>`;
            }

            return `
                <article class="faculty-card" data-school="${school}" data-index="${index}">
                    <h3 class="faculty-name">${faculty.name || 'Unknown'}</h3>
                    <div class="faculty-title">${faculty.title || ''}</div>
                    <span class="faculty-school school-${school}">${schoolLabel}</span>
                    ${contactHtml ? `<div class="contact-info">${contactHtml}</div>` : ''}
                    ${researchHtml}
                    ${actionsHtml}
                </article>
            `;
        }

        // Open email modal
        function openEmailModal(index) {
            const faculty = facultyData[index];
            if (!faculty || !faculty.email) return;

            currentEmailData = generateEmail(faculty);
            const lastName = faculty.name.split(',')[0].split(' ').pop().replace(/Professor|Dr\.|Prof\./gi, '').trim();

            document.getElementById('modalTitle').textContent = `Email to Prof. ${lastName}`;
            document.getElementById('modalEmailTo').textContent = `To: ${faculty.email}`;
            document.getElementById('emailSubject').textContent = currentEmailData.subject;
            document.getElementById('emailBody').textContent = currentEmailData.body;

            const mailtoLink = document.getElementById('mailtoLink');
            mailtoLink.href = `mailto:${faculty.email}?subject=${encodeURIComponent(currentEmailData.subject)}&body=${encodeURIComponent(currentEmailData.body)}`;

            document.getElementById('emailModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close email modal
        function closeEmailModal() {
            document.getElementById('emailModal').classList.remove('active');
            document.body.style.overflow = '';
            currentEmailData = null;
        }

        // Copy email to clipboard
        function copyEmail() {
            if (!currentEmailData) return;
            const fullEmail = `Subject: ${currentEmailData.subject}\n\n${currentEmailData.body}`;
            navigator.clipboard.writeText(fullEmail).then(() => {
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            });
        }

        // Render faculty cards
        function renderFaculty() {
            const grid = document.getElementById('facultyGrid');

            let filtered = facultyData.filter(f => {
                if (currentFilter !== 'all') {
                    const school = getSchool(f.department_source);
                    if (school !== currentFilter) return false;
                }
                if (currentSearch) {
                    const searchLower = currentSearch.toLowerCase();
                    const text = `${f.name} ${f.title} ${f.email} ${f.department_source} ${f.research_interests || ''}`.toLowerCase();
                    if (!text.includes(searchLower)) return false;
                }
                return true;
            });

            if (filtered.length === 0) {
                grid.innerHTML = '<div class="no-results">No faculty found matching your criteria.</div>';
                return;
            }

            grid.innerHTML = filtered.map((f, i) => {
                const originalIndex = facultyData.indexOf(f);
                return createCard(f, originalIndex);
            }).join('');
        }

        // Update stats
        function updateStats() {
            document.getElementById('totalCount').textContent = facultyData.length;
            document.getElementById('emailCount').textContent = facultyData.filter(f => f.email).length;
            document.getElementById('phoneCount').textContent = facultyData.filter(f => f.phone).length;
            document.getElementById('pubCount').textContent = facultyData.filter(f => f.top_publications && f.top_publications.length > 0).length;
        }

        // Load data
        async function loadData() {
            try {
                const response = await fetch('faculty_data.json');
                if (!response.ok) throw new Error('Failed to load data');
                facultyData = await response.json();
                updateStats();
                renderFaculty();
            } catch (error) {
                document.getElementById('facultyGrid').innerHTML = `
                    <div class="no-results">
                        <p>Error loading data. Make sure <code>faculty_data.json</code> exists.</p>
                        <p style="margin-top: 1rem; font-size: 0.9rem;">Run: <code>python -m http.server 8000</code></p>
                    </div>
                `;
            }
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            currentSearch = e.target.value;
            renderFaculty();
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderFaculty();
            });
        });

        // Close modal on overlay click
        document.getElementById('emailModal').addEventListener('click', (e) => {
            if (e.target.id === 'emailModal') closeEmailModal();
        });

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeEmailModal();
        });

        // Initialize
        loadData();
    </script>
</body>

</html>